#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Auto-bump version after commit based on commit message
COMMIT_MSG=$(git log -1 --pretty=%B)

if echo "$COMMIT_MSG" | grep -qE "^(feat|fix|docs|style|refactor|perf|test|chore):"; then
  echo "ðŸ”„ Auto-bumping version..."
  npm run version:bump
  
  # Add updated files if version changed
  if git diff --quiet package.json lib/version.ts; then
    echo "âœ… Version already up to date"
  else
    git add package.json lib/version.ts
    git commit --amend --no-edit --no-verify
    echo "âœ… Version updated and added to commit"
  fi
fi
